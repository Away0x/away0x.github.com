<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Rust | Away0x's Blog]]></title>
  <link href="http://away0x.github.io/blog/categories/rust/atom.xml" rel="self"/>
  <link href="http://away0x.github.io/"/>
  <updated>2021-10-07T19:04:35+08:00</updated>
  <id>http://away0x.github.io/</id>
  <author>
    <name><![CDATA[TongWu]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Rust - Install, Basic]]></title>
    <link href="http://away0x.github.io/blog/2021/10/01/rust-install/"/>
    <updated>2021-10-01T08:00:00+08:00</updated>
    <id>http://away0x.github.io/blog/2021/10/01/rust-install</id>
    <content type="html"><![CDATA[<!-- more -->


<ul>
<li><a href="#install">Install</a></li>
<li><a href="#basic">Basic</a></li>
</ul>


<h1><h2 id="install">Install</h2></h1>

<blockquote><p>å¦‚å®‰è£…å›°éš¾, å¯å‚è€ƒ <a href="https://rsproxy.cn/">https://rsproxy.cn/</a> é…ç½® proxy</p></blockquote>

<h2>rustup</h2>

<pre><code class="bash"># å®‰è£… rustup
curl --proto '=https' --tlsv1.2 https://sh.rustup.rs -sSf | sh
# éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ
rustc --version 
# æ›´æ–° rust ç‰ˆæœ¬
rustup update
# æ›´æ–° rustup
rustup self update
# å¸è½½ rust
rustup self uninstall
# æ‰“å¼€æœ¬åœ° rust æ–‡æ¡£
rustup doc
</code></pre>

<h2>cargo</h2>

<ul>
<li><a href="https://crates.io/">crates.io</a></li>
</ul>


<pre><code class="bash">cargo --version
# åˆ›å»ºé¡¹ç›®
# --lib åº“é¡¹ç›®
# --vcs=git æŒ‡å®šç‰ˆæœ¬æ§åˆ¶å·¥å…·
cargo new demo
# ç¼–è¯‘
# --release å‘å¸ƒæ—¶ç¼–è¯‘
cargo build
# ç¼–è¯‘å¹¶è¿è¡Œ
cargo run
# æ£€æŸ¥ä»£ç  (ä¸ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶)
cargo check
# æ ¼å¼åŒ–ä»£ç 
cargo fmt
# å‘å¸ƒ crate
cargo publish
cargo yank # æ’¤å›ç‰ˆæœ¬
# å®‰è£…äºŒè¿›åˆ¶æ–‡ä»¶
cargo install &lt;crate-name&gt; # ä¼šå®‰è£…åˆ° ï½/.cargo/bin
cargo install --force &lt;crate-name&gt; # é‡æ–°å®‰è£…
# ç”Ÿæˆæ–‡æ¡£å¹¶æ‰“å¼€
cargo doc --open
</code></pre>

<h1><h2 id="basic">Basic</h2></h1>

<ul>
<li>å‡½æ•°å’Œå˜é‡åä½¿ç”¨ snake case å‘½åè§„èŒƒ</li>
<li>traitã€struct ä½¿ç”¨ camel case å‘½åè§„èŒƒ</li>
</ul>


<h2>æ³¨é‡Š</h2>

<pre><code class="rust">// å•è¡Œæ³¨é‡Š
/**
    å¤šè¡Œæ³¨é‡Š
*/
</code></pre>

<pre><code class="rust">//! è¿™æ˜¯ä¸€ä¸ªæ¨¡å—çº§åˆ«çš„æ–‡æ¡£æ³¨é‡Š

/// è¿™æ˜¯ä¸€ä¸ªå‡½æ•°çš„æ–‡æ¡£æ³¨é‡Š (å¯ä½¿ç”¨ markdown è¯­æ³•)
/// å¯ä»¥ä½¿ç”¨ cargo doc --open ç”Ÿæˆæ–‡æ¡£
/// 
/// # Examples
/// ```
/// // ç¼–å†™ä¸€äº›ç¤ºä¾‹ (è¿è¡Œ cargo test çš„æ—¶å€™ï¼Œä¼šæŠŠç¤ºä¾‹çš„ä»£ç ä½œä¸ºæµ‹è¯•æ¥è¿è¡Œ)
/// let arg = 5;
/// let answer = add_one(arg);
/// assert_eq!(6, answer);
/// ```
/// 
/// # Panics
/// è¯´æ˜å‡½æ•°å¯èƒ½å‘ç”Ÿ panic çš„åœºæ™¯
/// 
/// # Errors
/// å¦‚æœå‡½æ•°è¿”å› Resultï¼Œæè¿°å¯èƒ½çš„é”™è¯¯ç§ç±»ï¼Œä»¥åŠå¯å¯¼è‡´é”™è¯¯çš„æ¡ä»¶
/// 
/// # Safety
/// å¦‚æœå‡½æ•°å¤„äº unsafe è°ƒç”¨ï¼Œå°±åº”è¯¥è§£é‡Š unsafe çš„åŸå› ï¼Œä»¥åŠè°ƒç”¨è€…ç¡®ä¿çš„ä½¿ç”¨å‰æ
pub fn add_one(x: i32) -&gt; i32 {
    x + 1
}
</code></pre>

<h2>Print</h2>

<pre><code class="rust">// print!ã€println!ã€eprint!ã€eprintln!
println!("{}", 2);
println!("{0}, this is {1}. {1}, this is {0}", "Alice", "Bob");
println!("{a} {b} {c}", a="a", b="b", c="c");
</code></pre>

<h2>Variable</h2>

<ul>
<li>ä½¿ç”¨ let å£°æ˜å˜é‡ï¼Œé»˜è®¤æƒ…å†µä¸‹å˜é‡æ˜¯ Immutable çš„</li>
<li>å£°æ˜å˜é‡æ—¶ï¼ŒåŠ ä¸Š mutï¼Œå°±å¯æ˜¯å˜é‡å¯å˜</li>
<li>Shadowing

<ul>
<li>å¯ä»¥ä½¿ç”¨ç›¸åŒçš„åå­—å£°æ˜æ–°çš„å˜é‡ï¼Œæ–°çš„å˜é‡ä¼š shadow ä¹‹å‰å£°æ˜çš„åŒåå˜é‡</li>
</ul>
</li>
</ul>


<pre><code class="rust">let x: u32 = 5; // åœ¨æ ˆä¸Šåˆ†é…ä¸€ä¸ªç±»å‹ä¸º u32 çš„å˜é‡, å˜é‡åä¸º x
x = 6; // Error: cannot assign twice to immutable variable

let mut y = 5;
y = 6; // OK
y = "y"; // ç±»å‹é”™è¯¯
</code></pre>

<pre><code class="rust">// shadow
let x = 5;
let x = x + 1;
let x = "x";
</code></pre>

<pre><code class="rust">// è§£æ„
let (mut a, mut b) = (1, 2);
let Point { x: ref a, y: ref b } = p;
</code></pre>

<h2>Constant</h2>

<ul>
<li>å¸¸é‡åœ¨ç»‘å®šå€¼åä¹Ÿæ˜¯ä¸å¯å˜çš„ï¼Œä½†æ˜¯å®ƒå’Œä¸å¯å˜çš„å˜é‡æœ‰å¾ˆå¤šåŒºåˆ«:

<ol>
<li>ä¸å¯ä»¥ä½¿ç”¨ mut, å¸¸é‡æ°¸è¿œéƒ½æ˜¯ä¸å¯å˜çš„</li>
<li>å£°æ˜å¸¸é‡ä½¿ç”¨ const å…³é”®å­—ï¼Œç±»å‹å¿…é¡»å¾—è¢«æ ‡æ³¨</li>
<li>å¸¸é‡å¯ä»¥åœ¨ä»»ä½•ä½œç”¨åŸŸå†…å£°æ˜ï¼ŒåŒ…æ‹¬å…¨å±€ä½œç”¨åŸŸ</li>
<li>å¸¸é‡åªå¯ä»¥ç»‘å®šåˆ°å¸¸é‡è¡¨è¾¾å¼ï¼Œæ— æ³•ç»‘å®šåˆ°å‡½æ•°çš„è°ƒç”¨ç»“æœæˆ–åªèƒ½åœ¨è¿è¡Œæ˜¯æ‰èƒ½è®¡ç®—å‡ºçš„å€¼</li>
</ol>
</li>
<li>ç¨‹åºè¿è¡ŒæœŸé—´ï¼Œå¸¸é‡åœ¨å…¶å£°æ˜çš„ä½œç”¨åŸŸå†…ä¸€ç›´æœ‰æ•ˆ</li>
<li>å‘½åè§„èŒƒ: ä½¿ç”¨å…¨å¤§å†™å­—æ¯ï¼Œå•è¯ä¹‹é—´ç”¨ä¸‹åˆ’çº¿åˆ†éš”</li>
</ul>


<pre><code class="rust">const MAX_POINTS: u32 = 100_1000;
</code></pre>

<h2>Static Variable</h2>

<ul>
<li>ä¸å¸¸é‡çš„åŒºåˆ«

<ol>
<li>é™æ€å˜é‡æœ‰å›ºå®šçš„å†…å­˜åœ°å€, ä½¿ç”¨å®ƒçš„å€¼æ€»ä¼šè®¿é—®åŒæ ·çš„æ•°æ®</li>
<li>å¸¸é‡å…è®¸ä½¿ç”¨å®ƒä»¬çš„æ—¶å€™å¯¹æ•°æ®è¿›è¡Œå¤åˆ¶</li>
<li>é™æ€å˜é‡: å¯ä»¥æ˜¯å¯å˜çš„, è®¿é—®å’Œä¿®æ”¹é™æ€å¯å˜å˜é‡æ˜¯ä¸å®‰å…¨çš„ (unsafe)</li>
</ol>
</li>
</ul>


<pre><code class="rust">// å…¨å±€å˜é‡
// å£°æ˜æ—¶å¿…é¡»åˆå§‹åŒ–ï¼Œä¸”åˆå§‹åŒ–å¿…é¡»ä¸ºç¼–è¯‘æœŸå¯ç¡®å®šçš„å¸¸é‡
// å…¨å±€å˜é‡è¯»å†™æ—¶éœ€è¦ç”¨ unsafe ä¿®é¥°
static GLOBAL: i32 = 0; // ç”Ÿå‘½å‘¨æœŸ('static)ä¸ºæ•´ä¸ªç¨‹åºè¿è¡ŒæœŸé—´
</code></pre>

<pre><code class="rust">// ä½¿ç”¨é™æ€å˜é‡æ—¶, ç”±äºä¸€äº›é™åˆ¶, å¯ä»¥ä½¿ç”¨ lazy_static å·¥å…·
// https://github.com/rust-lang-nursery/lazy-static.rs
static MAP: HashMap&lt;String, String&gt; = HashMap::new(); // æ— æ³•ç¼–è¯‘é€šè¿‡, éœ€è¦ç”¨ lazy_static
</code></pre>

<pre><code class="rust">use lazy_static::lazy_static;
use std::collections::HashMap;
use std::sync::{Arc, Mutex};

lazy_static! {
    static ref HASHMAP: Arc&lt;Mutex&lt;HashMap&lt;u32, &amp;'static str&gt;&gt;&gt; = {
        let mut m = HashMap::new();
        m.insert(0, "foo");
        m.insert(1, "bar");
        m.insert(2, "baz");
        Arc::new(Mutex::new(m))
    };
}

fn main() {
    let mut map = HASHMAP.lock().unwrap();
    map.insert(3, "waz");

    println!("map: {:?}", map);
}
</code></pre>

<h2>Types</h2>

<ul>
<li>Rust æ˜¯é™æ€ç¼–è¯‘è¯­è¨€ï¼Œåœ¨ç¼–è¯‘æ—¶å¿…é¡»çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹

<ul>
<li>åŸºäºä½¿ç”¨çš„å€¼ï¼Œç¼–è¯‘å™¨é€šå¸¸èƒ½å¤Ÿæ¨æ–­å‡ºå®ƒçš„å…·ä½“ç±»å‹</li>
<li>ä½†å¦‚æœå¯èƒ½çš„ç±»å‹æ¯”è¾ƒå¤š(ä¾‹å¦‚æŠŠ String è½¬ä¸ºæ•´æ•°çš„ parse æ–¹æ³•)ï¼Œå°±å¿…é¡»æ·»åŠ ç±»å‹æ ‡æ³¨ï¼Œå¦åˆ™ç¼–è¯‘ä¼šæŠ¥é”™</li>
</ul>
</li>
</ul>


<pre><code class="rust">let guess: u32 = "42".parse().expect("Not a number");
</code></pre>

<h3>æ ‡é‡ç±»å‹</h3>

<ul>
<li>ä¸€ä¸ªæ ‡é‡ç±»å‹ä»£è¡¨ä¸€ä¸ªå•ä¸ªçš„å€¼</li>
</ul>


<h4>æ•´æ•°ç±»å‹</h4>

<ul>
<li>æ•´æ•°ç±»å‹æ²¡æœ‰å°æ•°éƒ¨åˆ†

<ul>
<li>ä¾‹å¦‚ u32 å°±æ˜¯ä¸€ä¸ªæ— ç¬¦å·çš„æ•´æ•°ç±»å‹ï¼Œå æ® 32 ä½çš„ç©ºé—´</li>
</ul>
</li>
<li>æ— ç¬¦å·æ•´æ•°ç±»å‹ä»¥ u å¼€å¤´</li>
<li>æœ‰ç¬¦å·æ•´æ•°ç±»å‹ä»¥ i å¼€å¤´</li>
</ul>


<table>
<thead>
<tr>
<th> Length </th>
<th> Signed </th>
<th> Unsigned </th>
</tr>
</thead>
<tbody>
<tr>
<td> 8-bit </td>
<td> i8 </td>
<td> u8 </td>
</tr>
<tr>
<td> 16-bit </td>
<td> i16 </td>
<td> u16 </td>
</tr>
<tr>
<td> 32-bit </td>
<td> i32 </td>
<td> u32 </td>
</tr>
<tr>
<td> 64-bit </td>
<td> i64 </td>
<td> u64 </td>
</tr>
<tr>
<td> 128-bit </td>
<td> i128 </td>
<td> u128 </td>
</tr>
<tr>
<td> arch </td>
<td> isize </td>
<td> usize </td>
</tr>
</tbody>
</table>


<ul>
<li>isize å’Œ usize ç±»å‹çš„ä½æ•°ç”±ç¨‹åºè¿è¡Œçš„è®¡ç®—æœºçš„æ¶æ„å†³å®š

<ul>
<li>64 ä½è®¡ç®—æœºï¼Œé‚£å°±æ˜¯ 64 ä½çš„</li>
</ul>
</li>
<li>ä½¿ç”¨ isize/usize çš„ä¸»è¦åœºæ™¯æ˜¯å¯¹æŸç§é›†åˆè¿›è¡Œç´¢å¼•æ“ä½œ</li>
</ul>


<h5>æ•´æ•°å­—é¢å€¼</h5>

<ul>
<li>é™¤äº† byte ç±»å‹å¤–ï¼Œæ‰€æœ‰çš„æ•°å€¼å­—é¢å€¼éƒ½å…è®¸ä½¿ç”¨ç±»å‹åç¼€

<ul>
<li>ä¾‹å¦‚: <code>57u8</code></li>
</ul>
</li>
<li>æ•´æ•°çš„é»˜è®¤ç±»å‹å°±æ˜¯ <strong>i32</strong></li>
</ul>


<table>
<thead>
<tr>
<th> Number Literals </th>
<th> Example </th>
</tr>
</thead>
<tbody>
<tr>
<td> Decimal </td>
<td> <code>98_222</code> </td>
</tr>
<tr>
<td> Hex </td>
<td> <code>0xff</code> </td>
</tr>
<tr>
<td> Octal </td>
<td> <code>0077</code> </td>
</tr>
<tr>
<td> Binary </td>
<td> <code>0b1111_0000</code> </td>
</tr>
<tr>
<td> Byte(u8 only) </td>
<td> <code>b'A'</code> </td>
</tr>
</tbody>
</table>


<h5>æ•´æ•°æº¢å‡º</h5>

<ul>
<li>u8 èŒƒå›´æ˜¯ 0-255ï¼Œå¦‚æŠŠ u8 å˜é‡çš„å€¼è®¾ç½®ä¸º 256ï¼Œé‚£ä¹ˆ:

<ol>
<li>è°ƒè¯•æ¨¡å¼ä¸‹ç¼–è¯‘: Rust ä¼šæ£€æŸ¥æ•´æ•°æº¢å‡ºï¼Œå¦‚å‘ç”Ÿ, ç¨‹åºè¿è¡Œæ—¶ä¼š panic</li>
<li>release æ¨¡å¼ä¸‹ç¼–è¯‘: Rust ä¸ä¼šæ£€æŸ¥å¯èƒ½å¯¼è‡´ panic çš„æ•´æ•°æº¢å‡ºï¼Œå¦‚æº¢å‡ºå‘ç”Ÿï¼Œä¼šæ‰§è¡Œ &ldquo;ç¯ç»•æ“ä½œ&rdquo;

<ul>
<li>256 å˜æˆ 0ï¼Œ257 å˜æˆ 1 &hellip;</li>
<li>ä½†ç¨‹åºä¸ä¼š panic</li>
</ul>
</li>
</ol>
</li>
</ul>


<h4>æµ®ç‚¹ç±»å‹</h4>

<ul>
<li><strong>f32</strong>: 32 ä½ï¼Œå•ç²¾åº¦</li>
<li><strong>f64</strong>: 64 ä½ï¼ŒåŒç²¾åº¦</li>
<li>f64 æ˜¯é»˜è®¤ç±»å‹ï¼Œå› ä¸ºç°ä»£ CPU ä¸Š f64 å’Œ f32 é€Ÿåº¦å·®ä¸å¤šï¼Œè€Œä¸”ç²¾åº¦æ›´é«˜</li>
</ul>


<pre><code class="rust">let x = 2.0; // f64
let y: f32 = 3.0; // f32
</code></pre>

<h5>æ•°å€¼æ“ä½œ</h5>

<pre><code class="rust">let a = 5 + 10;
let b = 3.2 - 2.1;
let c = 2 * 3;
let d = 30 / 3;
let e = 54 % 5;
</code></pre>

<h4>å­—ç¬¦ç±»å‹</h4>

<ul>
<li>Rust è¯­è¨€ä¸­ char ç±»å‹è¢«ç”¨æ¥æè¿°è¯­è¨€ä¸­æœ€åŸºç¡€çš„å•ä¸ªå­—ç¬¦</li>
<li>å­—ç¬¦ç±»å‹çš„å­—é¢å€¼ä½¿ç”¨å•å¼•å·</li>
<li>å ç”¨ 4 å­—èŠ‚å¤§å°</li>
<li>æ˜¯ Unicode æ ‡é‡å€¼ï¼Œå¯ä»¥è¡¨ç¤ºæ¯” ASCII å¤šå¾—å¤šçš„å­—ç¬¦å†…å®¹: æ‹¼éŸ³ã€ä¸­æ—¥éŸ©æ–‡ã€é›¶é•¿åº¦ç©ºç™½å­—ç¬¦ã€emoji è¡¨æƒ…&hellip;

<ul>
<li>Unicode ä¸­å¹¶æ²¡å­—ç¬¦çš„æ¦‚å¿µï¼Œæ‰€ä»¥ç›´è§‰ä¸Šè®¤ä¸ºçš„å­—ç¬¦ä¹Ÿè®¸å’Œ Rust ä¸­çš„æ¦‚å¿µå¹¶ä¸ç›¸ç¬¦</li>
</ul>
</li>
</ul>


<pre><code class="rust">let x = 'z';
let y: char = 'ã€';
let z = 'ğŸ˜„';
</code></pre>

<h4>å¸ƒå°”ç±»å‹</h4>

<ul>
<li>true/false</li>
</ul>


<h3>å¤åˆç±»å‹</h3>

<ul>
<li>å¤åˆç±»å‹å¯ä»¥å°†å¤šä¸ªå€¼æ”¾åœ¨ä¸€ä¸ªç±»å‹é‡Œ</li>
<li>Rust æä¾›äº†ä¸¤ç§åŸºç¡€çš„å¤åˆç±»å‹: å…ƒç»„(Tuple)ã€æ•°ç»„</li>
</ul>


<h4>Tuple</h4>

<ul>
<li>å¯ä»¥å°†å¤šä¸ªç±»å‹çš„å¤šä¸ªå€¼æ”¾åœ¨ä¸€ä¸ªç±»å‹é‡Œé¢ï¼Œæ¯ä¸ªä½ç½®çš„ç±»å‹ä¸å¿…ç›¸åŒ</li>
<li>é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œä¸€æ—¦å£°æ˜å°±æ— æ³•æ›´æ”¹</li>
</ul>


<pre><code class="rust">let tup: (i32, f64, u8) = (500, 6.4, 1);
println!("{} {} {}", tup.0, tup.1, tup.2);
// ä½¿ç”¨æ¨¡å¼åŒ¹é…ç»“æ„ tuple
let (x, y, z) = tup;

// Empty Tuple (Unit ç±»å‹)
let empty: () = (); // ç©ºå…ƒç»„å ç”¨ 0 å†…å­˜ç©ºé—´
</code></pre>

<h4>æ•°ç»„</h4>

<ul>
<li>å¯ä»¥å°†å¤šä¸ªç±»å‹çš„å¤šä¸ªå€¼æ”¾åœ¨ä¸€ä¸ªç±»å‹é‡Œé¢ï¼Œæ¯ä¸ªä½ç½®çš„ç±»å‹å¿…é¡»ç›¸åŒ</li>
<li>é•¿åº¦æ˜¯å›ºå®šçš„ï¼Œä¸€æ—¦å£°æ˜å°±æ— æ³•æ›´æ”¹</li>
<li>å¦‚æƒ³è®©æ•°æ®å­˜æ”¾åœ¨ stack ä¸Šè€Œä¸æ˜¯ heap ä¸Šï¼Œæˆ–è€…æƒ³ä¿è¯æœ‰å›ºå®šæ•°é‡çš„å…ƒç´ ï¼Œè¿™æ—¶ä½¿ç”¨æ•°ç»„æ›´æœ‰å¥½å¤„

<ul>
<li>æ•°ç»„æ˜¯åœ¨ stack ä¸Šåˆ†é…çš„å•ä¸ªå—çš„å†…å­˜</li>
</ul>
</li>
<li>æ•°ç»„æ²¡æœ‰ Vector çµæ´»</li>
</ul>


<pre><code class="rust">let a = [1, 2, 3];
// æ•°ç»„çš„ç±»å‹ [ç±»å‹; é•¿åº¦]
let b: [u32; 2] = [1, 2];

// å¦‚æœæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ å€¼éƒ½ç›¸åŒå¯ä»¥è¿™æ ·å£°æ˜
let c = [3; 5]; // ç›¸å½“äº let c = [3, 3, 3, 3, 3];

// è®¿é—®æ•°ç»„å…ƒç´ 
// - å¦‚æœç´¢å¼•è¶…å‡ºæ•°ç»„èŒƒå›´ï¼Œç¼–è¯‘ä¼šæŠ¥é”™
// - å¦‚æœç´¢å¼•æ˜¯åŠ¨æ€çš„ï¼Œé‚£ä¹ˆç¼–è¯‘ä¼šé€šè¿‡ï¼Œè¿è¡Œæ—¶ä¼šæŠ¥é”™
let d = c[0];
</code></pre>

<h3>æŒ‡é’ˆç±»å‹</h3>

<p>æ™ºèƒ½æŒ‡é’ˆ</p>

<table>
<thead>
<tr>
<th> ç±»å‹å </th>
<th> ç®€ä»‹ </th>
</tr>
</thead>
<tbody>
<tr>
<td> <code>Box&lt;T&gt;</code> </td>
<td> æŒ‡å‘ç±»å‹ T çš„ã€å…·æœ‰æ‰€æœ‰æƒçš„æŒ‡é’ˆï¼Œæœ‰æƒé‡Šæ”¾å†…å­˜ </td>
</tr>
<tr>
<td> <code>&amp;T</code> </td>
<td> æŒ‡å‘ç±»å‹ T çš„å€Ÿç”¨æŒ‡é’ˆã€ä¹Ÿç§°ä¸ºå¼•ç”¨ï¼Œæ— æƒé‡Šæ”¾å†…å­˜ï¼Œæ— æƒå†™æ•°æ® </td>
</tr>
<tr>
<td> <code>&amp;mut T</code> </td>
<td> æŒ‡å‘ç±»å‹ T çš„ mut å‹å€Ÿç”¨æŒ‡é’ˆï¼Œæ— æƒé‡Šæ”¾å†…å­˜ï¼Œæœ‰æƒå†™æ•°æ® </td>
</tr>
<tr>
<td> <code>*const T</code> </td>
<td> æŒ‡å‘ç±»å‹ T çš„åªè¯»è£¸æŒ‡é’ˆï¼Œæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸä¿¡æ¯ï¼Œæ— æƒå†™æ•°æ® </td>
</tr>
<tr>
<td> <code>*mut T</code> </td>
<td> æŒ‡å‘ç±»å‹ T çš„å¯è¯»å†™è£¸æŒ‡é’ˆï¼Œæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸä¿¡æ¯ï¼Œæœ‰æƒå†™æ•°æ® </td>
</tr>
<tr>
<td> <code>Rc&lt;T&gt;</code> </td>
<td> æŒ‡å‘ç±»å‹ T çš„å¼•ç”¨è®¡æ•°æŒ‡é’ˆï¼Œå…±äº«æ‰€æœ‰æƒï¼Œçº¿ç¨‹ä¸å®‰å…¨ </td>
</tr>
<tr>
<td> <code>Arc&lt;T&gt;</code> </td>
<td> æŒ‡å‘ç±»å‹ T çš„åŸå­å¼•ç”¨è®¡æ•°æŒ‡é’ˆï¼Œå…±äº«æ‰€æœ‰æƒï¼Œçº¿ç¨‹å®‰å…¨ </td>
</tr>
<tr>
<td> <code>Cow&lt;'a, T&gt;</code> </td>
<td> Clone-on-write, å†™æ—¶å¤åˆ¶æŒ‡é’ˆã€‚å¯èƒ½æ˜¯å€Ÿç”¨æŒ‡é’ˆï¼Œä¹Ÿå¯èƒ½æ˜¯å…·æœ‰æ‰€æœ‰æƒçš„æŒ‡é’ˆ </td>
</tr>
</tbody>
</table>


<h3>Never ç±»å‹</h3>

<ul>
<li>åä¸º <code>!</code> çš„ç‰¹æ®Šç±»å‹, æ²¡æœ‰ä»»ä½•å€¼, åœ¨ä¸è¿”å›å€¼çš„å‡½æ•°ä¸­å……å½“è¿”å›ç±»å‹

<ul>
<li>ä¸è¿”å›å€¼çš„å‡½æ•°ä¹Ÿè¢«ç§°ä¸ºå‘æ•£å‡½æ•° (diverging function)</li>
<li>never å¯å¼ºè½¬ä¸ºä»»ä½•å…¶ä»–ç±»å‹</li>
</ul>
</li>
</ul>


<pre><code class="rust">let guess: u32 = match guess.trim().parse() {
    Ok(num) =&gt; num,
    // continue è¿”å› never ç±»å‹, never å¯å¼ºè½¬ä¸ºä»»ä½•å…¶ä»–ç±»å‹,
    // æ‰€ä»¥è¯¥åˆ†æ”¯å¯ä»¥ä½¿ç”¨ continue ä½œä¸º u32 ç±»å‹
    Err(_) =&gt; continue,
};
</code></pre>

<pre><code class="rust">fn bar() -&gt; ! {
    loop {} // æ­¤å¤„æ°¸è¿œæ²¡æœ‰è¿”å›å€¼, æ‰€ä»¥ç±»å‹ä¸º never
}

impl&lt;T&gt; Option&lt;T&gt; {
    pub fn unwrap(self) -&gt; T {
        match self {
            Some(val) =&gt; val,
            // panic æ˜¯ never, æ‰€ä»¥å¯ä»¥ä½œä¸º T ä½¿ç”¨
            None =&gt; panic!("called `Option::unwrap()` on a `None` value"),
        }
    }
}
</code></pre>

<h3>ç±»å‹è½¬æ¢</h3>

<ul>
<li>Rust ä¸æä¾›åŸç”Ÿç±»å‹ä¹‹é—´çš„éšå¼è½¬æ¢ï¼Œå¾—ä½¿ç”¨ <code>as</code> å…³é”®å­—æ˜¾å¼è½¬æ¢</li>
<li>ç›¸ä¼¼ç±»å‹çš„è½¬æ¢:

<ul>
<li><code>as</code></li>
<li><code>T.into()</code>: å˜é‡éœ€è¦æ˜¾å¼æ ‡æ³¨ç±»å‹</li>
</ul>
</li>
</ul>


<pre><code class="rust">let v1: i8 = 41;
let v2: i16 = v1 as i16; // ä¹Ÿå¯ v1.into()

let i = 42;
let p = &amp;i as *const i32 as *mut i32;
println!("{:?}", p);
</code></pre>

<h3>ç±»å‹åˆ«å</h3>

<pre><code class="rust">type Age = u32;
type Double&lt;T&gt; = (T, Vec&lt;T&gt;);
</code></pre>

<h2>Function</h2>

<h3>è¡¨è¾¾å¼ä¸è¯­å¥</h3>

<ul>
<li>å‡½æ•°ä½“ç”±ä¸€ç³»åˆ—è¯­å¥ç»„æˆï¼Œå¯é€‰çš„ç”±ä¸€ä¸ªè¡¨è¾¾å¼ç»“æŸ</li>
<li>Rust æ˜¯ä¸€ä¸ªåŸºäºè¡¨è¾¾å¼çš„è¯­è¨€

<ul>
<li>è¯­å¥æ˜¯æ‰§è¡Œä¸€äº›åŠ¨ä½œçš„æŒ‡ä»¤</li>
<li>è¡¨è¾¾å¼ä¼šè®¡ç®—äº§ç”Ÿä¸€ä¸ªå€¼</li>
</ul>
</li>
<li>è¯­å¥æ²¡æœ‰è¿”å›å€¼ï¼Œæ‰€ä»¥ä¸å¯ä»¥ä½¿ç”¨ let å°†ä¸€ä¸ªè¯­å¥èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡</li>
</ul>


<pre><code class="rust">let y = 6; // è¯­å¥
let x = (let y = 6); // æŠ¥é”™

let y = {
    let x = 1;
    x + 3 // è¡¨è¾¾å¼äº§ç”Ÿçš„å€¼ (ä¸åŠ åˆ†å·, åŠ åˆ†å·äº§ç”Ÿçš„å€¼ä½ unit type)
};
</code></pre>

<pre><code class="rust">// å£°æ˜å‡½æ•° (å‡½æ•°çš„å®šä¹‰ä¹Ÿæ˜¯è¯­å¥)
fn test() {
    println!("test");
}
fn test2(x: i32, y: i32) {}
test2(5, 6);

// è¿”å›å€¼æ˜¯å‡½æ•°ä½“é‡Œæœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼
// å¦‚æƒ³æå‰è¿”å›ï¼Œå¯ä»¥ä½¿ç”¨ return å…³é”®å­—ï¼ŒæŒ‡å®šä¸€ä¸ªå€¼
fn test3(x: i32) -&gt; i32 {
    x + 5
}
let x = test3(6); // 11
</code></pre>

<h2>Control Flow</h2>

<h3>if else</h3>

<ul>
<li>if æ˜¯è¡¨è¾¾å¼ï¼Œä¼šäº§ç”Ÿå€¼ï¼Œif æ¡ä»¶å¿…é¡»å¾—æ˜¯ bool ç±»å‹</li>
<li>å¦‚æœç¨‹åºä¸­ä½¿ç”¨äº†å¤šäºä¸€ä¸ªçš„ else ifï¼Œé‚£ä¹ˆæœ€å¥½ä½¿ç”¨ match æ¥é‡æ„</li>
</ul>


<pre><code class="rust">let number = 6;
if number % 4 == 0 {
    println!("number is divisible by 4");
} else if number % 3 == 0 {
    println!("number is divisible by 3");
} else {
    println!("number is not divisible by 4 or 3");
}

// if æ˜¯è¡¨è¾¾å¼
let condition = true;
let number = if condition { 5 } else { 6 }; // æ¯ä¸ªåˆ†æ”¯äº§ç”Ÿçš„å€¼ï¼Œç±»å‹å¿…é¡»ä¸€è‡´
</code></pre>

<h3>loop</h3>

<pre><code class="rust">loop {
    println!("again!");
}

let mut counter = 0;
let result = loop {
    counter += 1;
    if counter == 10 {
        break counter * 2; // ä½œä¸ºè¡¨è¾¾å¼ç»“æœ
    }
};

println!("The result is: {}", result); // The result is: 20
</code></pre>

<h3>while</h3>

<pre><code class="rust">let mut number = 3;
while number != 0 {
    println!("{}", number);
    number = number - 1;
}
</code></pre>

<h3>for</h3>

<blockquote><p>for å¯ä»¥ç”¨äºä»»ä½•å®ç°äº† IntoIterator trait çš„æ•°æ®ç»“æ„</p></blockquote>

<p>åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒIntoIterator ä¼šç”Ÿæˆä¸€ä¸ªè¿­ä»£å™¨ï¼Œfor å¾ªç¯ä¸æ–­ä»è¿­ä»£å™¨ä¸­å–å€¼ï¼Œç›´åˆ°è¿­ä»£å™¨è¿”å› None ä¸ºæ­¢ã€‚å› è€Œï¼Œfor å¾ªç¯å®é™…ä¸Šåªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œç¼–è¯‘å™¨ä¼šå°†å…¶å±•å¼€ä½¿ç”¨ loop å¾ªç¯å¯¹è¿­ä»£å™¨è¿›è¡Œå¾ªç¯è®¿é—®ï¼Œç›´è‡³è¿”å› None</p>

<pre><code class="rust">let a = [10, 20, 30, 40, 50];
for element in a {
    println!("the value is: {}", element);
}
</code></pre>

<pre><code class="rust">let v = vec![10, 42, 9, 8];
for item in v {
    println!("{}", item);
}

let v = vec![10, 42, 9, 8];
for (index, value) in v.iter().enumerate() {
    println!("index: {}, value: {}", index, value);
}
</code></pre>

<h4>for æ­é… range ä½¿ç”¨</h4>

<pre><code class="rust">for number in (1..4).rev() {
    println!("{}", number);
}
// rev å€’åºå¾ªç¯
// ä¾æ¬¡è¾“å‡º 3 2 1
</code></pre>
]]></content>
  </entry>
  
</feed>
